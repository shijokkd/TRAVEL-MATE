"use strict";(this.webpackChunk_hz_project_x=this.webpackChunk_hz_project_x||[]).push([[36514],{728564:(e,t,s)=>{var i,r,n,o,a,d,c;s.d(t,{$H:()=>c,Lb:()=>i,Sp:()=>o,Wt:()=>r,ZH:()=>d,uv:()=>n,zK:()=>a}),function(e){e.PROFILE_AVAILABLE="PROFILE_AVAILABLE",e.PROFILE_EXPIRED="PROFILE_EXPIRED",e.PROFILE_DENIED="PROFILE_DENIED",e.PROFILE_UNAVAILABLE="PROFILE_UNAVAILABLE"}(i||(i={})),function(e){e.LICENSE="LICENSE",e.ACQUIRED_OFFER="ACQUIRED_OFFER",e.CONFIGURED_LICENSE="CONFIGURED_LICENSE",e.PURCHASED_ENTITLEMENT="PURCHASED_ENTITLEMENT",e.TEMPORARY_ENTITLEMENT="TEMPORARY_ENTITLEMENT",e.OUTAGE_TEMPORARY_ENTITLEMENT="OUTAGE_TEMPORARY_ENTITLEMENT",e.FREE_ENTITLEMENT="FREE_ENTITLEMENT",e.OTHER="OTHER"}(r||(r={})),function(e){e.PAID_ENTITLED="premium_entitlement",e.TRIAL_ENTITLED="premium_trial_entitlement",e.FREE_ENTITLED="free_entitlement",e.UNAUTHENTICATED="unauthenticated",e.OTHER="error_unknown"}(n||(n={})),function(e){e.ALL_APPS="All_Apps",e.PHOTOSHOP="Photoshop_SA",e.ILLUSTRATOR="Illustrator_SA",e.INDESIGN="Indesign_SA",e.PREMIERE_PRO="Premiere_Pro_SA",e.AFTER_EFFECTS="After_Effects_SA",e.DREAMWEAVER="Dreamweaver_SA",e.LIGHTROOM="Lightroom_SA",e.AUDITION="Audition_SA",e.FRESCO="Fresco_SA",e.EXPRESS_PREMIUM_OR_OTHER="Express_Premium_or_Others",e.EXPRESS_FREE_OR_OTHER="Express_Free_or_Others",e.UNAUTHENTICATED_OR_UNKNOWN="Unauthenticated_or_Unknown"}(o||(o={})),function(e){e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE"}(a||(a={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.PROFILE_FREE=1]="PROFILE_FREE",e[e.PROFILE_DENIED=2]="PROFILE_DENIED",e[e.NO_ACCESSIBLE_ITEMS=3]="NO_ACCESSIBLE_ITEMS",e[e.MISSING_REQUIRED_ENTITLEMENTS=4]="MISSING_REQUIRED_ENTITLEMENTS"}(d||(d={})),function(e){e.TYPE1="type1",e.TYPE2="type2",e.TYPE3="type3",e.TYPE2E="type2e",e.UNKNOWN="unknown"}(c||(c={}))},724106:(e,t,s)=>{s.d(t,{v:()=>d});var i=s(721061),r=s(470044),n=s(772937);const o={loggedOffUserSupport:new n.L0("logged-out-user-support",!1),customSignInEnabled:new n.L0("use-custom-sign-in",!1),customizeSUSIWithDCP:new n.L0("customize-susi-with-dcp",!1)};var a=s(34982);class d{constructor(){this.id=d.id,this.dependencies=["@hz/client-storage"]}async onActivate({locator:e}){const t=await e.get("AppConfig");await t.attach(o);const s=o.loggedOffUserSupport.enabled,n=o.customSignInEnabled.enabled,a=await e.get("SessionStorageService");e.set("SessionPersistenceService",(async()=>new r.Uz(a))),e.set("ImsService",(async()=>{const[t,r,o,d]=await e.getAll(["Logger","SessionPersistenceService","PerfMonitorModel","ImsServiceOptions"]);return new i.E$(t,r,a,o,d,{allowLoggedOutUser:s,customSignInEnabled:n})}))}}d.id="@hz/ims-service-client",d.dependencies=[a.X]},721061:(e,t,s)=>{s.d(t,{E$:()=>l,oU:()=>c});var i=s(718537),r=s(197275),n=s(843074),o=s(47346),a=s(470044);const d="anonymous_user_id";var c,h;!function(e){e.uninitialized="uninitialized",e.anonymous="anonymous",e.authenticated="authenticated",e.expired="expired"}(c||(c={})),function(e){e.imsLoad="ims-load"}(h||(h={}));class l{constructor(e,t,s,l,_,u={allowLoggedOutUser:!1,customSignInEnabled:!1},g=navigator){this._logger=e,this._sessionPersistenceService=t,this._sessionStorageService=s,this._perf=l,this._imsServiceOptions=_,this.features=u,this._navigator=g,this._userState=c.uninitialized,this._tokenListeners=new Set,this._profileListeners=new Set,this._modalSignInDeferred=new n.B,this._modalSUSICallbackAttached=!1,this._locale="en_US",this._customSignInCallback=void 0,this._customSignInDeferred=void 0,this.processServiceWorkerMessage=async e=>{if("AUTHENTICATION_FAILURE"===e.data.msg){if(this.allowLoggedOutUser&&this.isAnonymousUser())return;let e=!1;try{e=await this._adobeIMS.validateToken()}finally{e||await this._signInInternal("token is not valid",{},!0)}}},this._modalSUSICallbackFunc=e=>{const t=this._modalSignInOptions?.redirect_uri,s=e.origin.includes("adobe.com")||e.origin===window.location.origin;e.data?.includes("wasmodal")&&s?(t&&this._reload(`${t}`),this._modalSignInDeferred.resolve()):this._modalSignInDeferred.reject("unable to sign in. Try again later."),window.removeEventListener("message",this._modalSUSICallbackFunc),this._modalSUSICallbackAttached=!1},this._onAccessToken=e=>{const t=this._userState===c.anonymous;this._userState=c.authenticated,e.token!==this._currentToken&&(this._currentToken=e.token,this._tokenListeners.forEach((t=>t(e.token))),this._scheduleTokenRefresh(e.expire?.getTime?.()-18e4-Date.now())),t&&(this._profilePromise=void 0,this.getProfile().then((()=>this._profileListeners.forEach((e=>e()))))),this._imsDeferred?.isSettled||this._imsDeferred?.resolve()},this._onReady=async()=>{(0,a.tz)(),this.isSignedInUser()||await this._onAccessTokenHasExpired(),this.allowLoggedOutUser||await this.ensureSignedInUser()},this._onAccessTokenHasExpired=async()=>{this._userState!==c.uninitialized&&this._userState!==c.authenticated||(this._userState=this._userState===c.uninitialized?c.anonymous:c.expired,this._userState===c.anonymous&&this.allowLoggedOutUser&&this._makeAnonymousProfile(),this._userState!==c.expired&&this.allowLoggedOutUser||await this._signInInternal("access token expired",{},!0),this._imsDeferred?.isSettled||this._imsDeferred?.resolve())},this._onError=(e,t)=>{if(!this.adobeIdData.overrideErrorHandler||!this._imsDeferred?.isSettled)throw this._imsDeferred?.reject(t),new r.R("ImsError",e,new Error(t))},this._generateAnonymousUserId=()=>`${(0,o.Z)()}@anonymous`,this._persistAnonymousProfile=(e,t)=>{this._sessionStorageService.setInStorage(d,JSON.stringify({userId:e,name:t}))},this._retrieveAnonymousProfile=()=>{try{return JSON.parse(this._sessionStorageService.getFromStorage(d)??"")}catch(e){return}},this._makeAnonymousProfile=()=>{const e=this._retrieveAnonymousProfile(),{userId:t,name:s}=e??{userId:this._generateAnonymousUserId(),name:"Guest"};e||this._persistAnonymousProfile(t,s),this._profilePromise=Promise.resolve({account_type:"anonymous",countryCode:"UD",displayName:s,email:"",emailVerified:"false",first_name:s,last_name:"",mrktPerm:"",mrktPermEmail:"false",name:s,phoneNumber:"",preferred_languages:null,userId:t,utcOffset:""})},this._overrideErrorHandlerFunction=e=>{const t=new URL(window.location.href);return t.searchParams.set("redirectError",JSON.stringify(e)),window.history.replaceState(null,"",t),this._logger?.debug(`Check token error in embed context. Error: ${JSON.stringify(e)}`),this._imsDeferred?.isSettled||this._imsDeferred?.resolve(),!1},this._perf.beginStartupAction(h.imsLoad);const{allowLoggedOutUser:m,customSignInEnabled:S}=u;this.allowLoggedOutUser=Boolean(m),this.customSignInEnabled=Boolean(S),this._adobeIMS=new i.H(this.adobeIdData),window.adobeIMS=this._adobeIMS,window.adobeid=this._adobeIMS.adobeid;const{customSignInCallback:I}=this._imsServiceOptions;I&&this.registerCustomSignInCallback(I)}get locale(){return this._locale}set locale(e){this._locale=e}get adobeIMS(){return this._adobeIMS}get adobeIdData(){const e={client_id:this._imsServiceOptions.clientId,environment:this._imsServiceOptions.environment,alwaysRemoveTokenFromUrl:!0,scope:this._imsServiceOptions.scope,useLocalStorage:!1,autoValidateToken:!0,modalMode:this.isLoadedInIFrame(),modalSettings:{allowedOrigin:location.protocol+"//"+location.host},onReady:this._onReady,onError:this._onError,onAccessToken:this._onAccessToken,onAccessTokenHasExpired:this._onAccessTokenHasExpired};return this._addEmbedSpecificParams(e),e}get isLoaded(){return!0===this._imsDeferred?.isSettled}registerCustomSignInCallback(e){this.customSignInEnabled&&(this._customSignInCallback=e)}async load(){return this._imsDeferred||(this._imsDeferred=new n.B,this._imsDeferred.promise.then((()=>this._perf.endStartupAction(h.imsLoad))),this._adobeIMS.adobeIdData.alwaysRemoveTokenFromUrl=!0,await this.adobeIMS.initialize(),this.registerServiceWorkerMessage()),this._imsDeferred.promise}registerServiceWorkerMessage(){try{if(!("serviceWorker"in this._navigator))return;this._navigator.serviceWorker.removeEventListener("message",this.processServiceWorkerMessage),this._navigator.serviceWorker.addEventListener("message",this.processServiceWorkerMessage)}catch(e){this._logger.error(`Failed to add service worker message event listener ${e}`)}}isSignedInUser(){return this.adobeIMS.isSignedInUser()}isAnonymousUser(){return this._userState===c.anonymous}async getProfile(){return this.allowLoggedOutUser?await this.load():await this.ensureSignedInUser(),this._profilePromise||(this._profilePromise=this.adobeIMS.getProfile()),this._profilePromise}async getAccessTokenValue(){return this.isLoaded||await this.load(),this._currentToken??this.adobeIMS.getAccessToken()?.token}addTokenListener(e){this._tokenListeners.add(e)}removeTokenListener(e){this._tokenListeners.delete(e)}addProfileListener(e){this._profileListeners.add(e)}removeProfileListener(e){this._profileListeners.delete(e)}async updateAnonymousProfile(e){const{userId:t}=this._retrieveAnonymousProfile();this._persistAnonymousProfile(t??this._generateAnonymousUserId(),e),this._makeAnonymousProfile(),this._profileListeners.forEach((e=>e()))}async ensureSignedInUser(e=!1){this.isLoaded||await this.load(),this.allowLoggedOutUser&&!e||this.isSignedInUser()||await this._signInInternal("user not signed in",{},!0)}async _signInCustom(e,t){if(!this.customSignInEnabled||!this._customSignInCallback)return this._signIn(e,t);if(this._customSignInDeferred)return this._customSignInDeferred.promise;this._customSignInDeferred=new n.B,this._logger.debug(`Will redirect to custom sign in screen. Reason: ${e}`),this._makeAnonymousProfile(),this._userState=c.anonymous,this._imsDeferred?.isSettled||this._imsDeferred?.resolve();try{await this._customSignInCallback(t),this._customSignInDeferred?.resolve(),this._customSignInDeferred=void 0}catch(s){return this._logger.debug(`Couldn't invoke custom sign in flow, falling back to IMS sign in: ${s}`),this._signIn(e,t)}}async _signInInternal(e,t,s=!1){if(this.customSignInEnabled&&s)return this._signInCustom(e,t);await this._signIn(e,t)}_getSignInOptions(e){let t={};return this._imsServiceOptions.imsDcpIdForCustomSUSI&&(t={dctx_id:this._imsServiceOptions.imsDcpIdForCustomSUSI}),{...e,locale:e?.locale||this._locale,...t}}async _signIn(e,t){this._logger?.debug(`Will redirect to IMS login. Reason: ${e}`);const s=this._getSignInOptions(t);return new Promise((()=>{this.adobeIMS.signIn(s)}))}async _signUp(e,t){this._logger?.debug(`Will redirect to IMS Sign Up. Reason: ${e}`);const s=this._getSignInOptions(t);return new Promise((()=>{this.adobeIMS.signUp(s)}))}_inIframeSignIn(e,t){return this._logger?.debug(`Will launch pop window of IMS login. Reason: ${e}`),this._modalSignInOptions=t,this._modalSUSICallbackAttached||window.addEventListener("message",this._modalSUSICallbackFunc),this.adobeIMS.signIn({...t,locale:t?.locale||this._locale}),this._modalSignInDeferred.promise}_inIframeSignUp(e,t){return this._logger?.debug(`Will launch pop window of IMS SignUp. Reason: ${e}`),this._modalSignInOptions=t,this._modalSUSICallbackAttached||window.addEventListener("message",this._modalSUSICallbackFunc),this.adobeIMS.signUp({...t,locale:t?.locale||this._locale}),this._modalSignInDeferred.promise}_reload(e){window.location.assign(e)}signOut(e){this.adobeIMS.signOut(e)}getRedirectUrl(e){const t=e?new URL(e):new URL(window.location.href);return(0,a.F0)(this._sessionPersistenceService.getOtpToken(),t)}async _signInWithSocialProvider(e,t){return new Promise((()=>{this.adobeIMS.signInWithSocialProvider(e,{...t,locale:t?.locale||this._locale})}))}async signInWithSocialProvider(e,t){const s={redirect_uri:this.getRedirectUrl(t).href};await this._signInWithSocialProvider(e,s)}async customSignIn(e){await this.signIn(e,!0)}async signIn(e,t=!1,s={}){const i=this.getRedirectUrl(e),r="Manual trigger",n={...s,redirect_uri:i.href};if(this.isLoadedInIFrame())return i.searchParams.set("_cb",`${Date.now()}`),n.redirect_uri=i.href,void await this._inIframeSignIn(r,n);await this._signInInternal(r,n,t)}async signUp(e){const t=this.getRedirectUrl(e),s="Manual trigger",i={redirect_uri:t.href};if(this.isLoadedInIFrame())return t.searchParams.set("_cb",`${Date.now()}`),i.redirect_uri=t.href,void await this._inIframeSignUp(s,i);await this._signUp(s,i)}_getTopWindow(){return window.top}_getCurrentWindow(){return window.self}isLoadedInIFrame(){return this._getTopWindow()!==this._getCurrentWindow()}async refreshToken(){return this._refreshTokenPromise||(this._refreshTokenPromise=new Promise((async e=>{try{this._logger.info("refreshToken is starting"),await this.adobeIMS.refreshToken(),e("noError")}catch(t){"rate_limited"===t.error?(this._logger.warn(`refreshToken failed. The server requested a retry after ${t.retryAfter} seconds"`),e(Number(t.retryAfter))):(this._logger.warn(`refreshToken failed with error "${t.error}"`),e(String(t.error)))}this._refreshTokenPromise=void 0}))),this._refreshTokenPromise}_scheduleTokenRefresh(e){!e||e<0||(clearTimeout(this._tokenRefreshTimeout),this._tokenRefreshTimeout=window.setTimeout((()=>this.refreshToken()),e))}_addEmbedSpecificParams(e){const t=new URLSearchParams(window.location.search);t.get("embed")&&(t.get("userId")&&(e.api_parameters={...e.api_parameters,check_token:{user_id:t.get("userId")}}),e.analytics={appCode:"embed_"+t.get("ccEverywhereHostClientId")},e.redirect_uri=this.getRedirectUrl().toString(),e.overrideErrorHandler=this._overrideErrorHandlerFunction)}}},470044:(e,t,s)=>{s.d(t,{F0:()=>a,Uz:()=>d,tz:()=>o});const i="hz_persistence",r="otp",n=/&?otp=(\d+)/,o=()=>{const e=window.location.hash.replace(n,"");""===e?window.history.replaceState(null,"",window.location.pathname+window.location.search):window.location.hash=e},a=(e,t)=>{const s=t.hash?"&":"";return t.hash+=`${s}otp=${e}`,t};class d{constructor(e){this._storedData={},this._sessionStorageService=e,this._restoredData=this._restoreData(),this.persist(r,Math.random().toFixed(10).substring(3))}getOtpToken(){return this._storedData[r]}getRestoredData(e){return this._restoredData[e]}persist(e,t){this._storedData[e]=t,this._sessionStorageService.setInStorage(i,JSON.stringify(this._storedData))}remove(e){delete this._restoredData[e],delete this._storedData[e],this._sessionStorageService.setInStorage(i,JSON.stringify(this._storedData))}_restoreData(){const e=this._getPersistedData();return e[r]!==(window.location.hash.match(n)?.[1]||"")?[]:e}_getPersistedData(){try{return JSON.parse(this._sessionStorageService.getFromStorage(i)??"{}")}catch(e){return{}}}}},327585:(e,t,s)=>{s.d(t,{Kj:()=>r,ei:()=>n});class i extends Error{}function r(e,t,s){const r=new Promise(((e,r)=>{setTimeout((()=>{r(new i(s||`Promise timed out after ${t}ms`))}),t)}));return Promise.race([e,r])}function n(e,t,s){let r=!1;const n=new Promise(((e,n)=>{setTimeout((()=>{n(new i(s||`Promise timed out after ${t}ms`)),r=!0}),t)}));return Promise.race([e((function(){return r})),n])}},34982:(e,t,s)=>{s.d(t,{X:()=>a});var i=s(386475);class r extends i.c{get storage(){return window.localStorage}}var n=s(417582);class o{read(e){const t=encodeURIComponent(e);let s;if(document.cookie.split(";").some((e=>e.replace(/\s*=.*$/,"").trim()===t&&(s=decodeURIComponent(e.replace(/^[^=]+=\s*/,"").trim()),!0))))return s}write(e,t,s={}){const{path:i,domain:r,maxAge:n,expires:o,samesite:a,secure:d}=s,c=[`${encodeURIComponent(e)}=${encodeURIComponent(t)}`];i&&i.length>0?c.push(`path=${encodeURI(i)}`):void 0===i&&c.push("path=/"),r&&r.length>0&&c.push(`domain=${r}`),n&&n>0&&c.push(`max-age=${n}`),o&&c.push(`expires=${o.toUTCString()}`),!0===d&&c.push("secure"),a&&c.push(`samesite=${a}`),document.cookie=c.join("; ")}delete(e){this.write(e,"",{expires:new Date(0)})}}class a{constructor(){this.id=a.id,this.dependencies=[]}async onActivate({locator:e}){const t=await e.get("Logger");e.set("LocalStorageService",(async()=>new r(t))),e.set("SessionStorageService",(async()=>new n.u(t))),e.set("CookiesUtils",(async()=>new o))}}a.id="@hz/client-storage",a.dependencies=[]}}]);
//# sourceMappingURL=36514.06047676db7fb8d385bf.js.map